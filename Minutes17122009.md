# Present #

Leo, Egon, Nico, Duncan, Janna


# Minutes #


## niko/ georg classifier ##
  * maybe evaluate on subset rather than whole ontology? (generate "nice" test set with compounds for evaluation)


## classification by functional groups? ##
  * how are functional groups defined?

Exhaustive list of functional groups within all molecules in pathway. Consensus fingerprint of functional groups. Remember which FG leads to which molecule. Looking for big MCS present in class as well. Reasonable fast with SPARQL queries for database searching. Go through every atom in molecule and save connectivity to nearest neighbours (1-2-3 etc) I.e. paths through molecule.

Reasoner based querying with all functional groups within molecule is veeeeery slow (but we haven't tried all the reasoners, this is just a general statement regarding the reasoner, Pellet I believe, and the approach we tried - Leo).

SPARQL querying with Virtuoso is fast enough (knowledge base expressed in RDFS).

LIPIDMAPS set of classes with specification (Leo and Michel). We were trying to use the dataset to infer the functional groups, or substructures, necessary to identify a class. The RDF molecular specification (through CHESS) was used because it has the benefit of an added ability to fuse disparate chemical databases and we can represent and later recall parts of molecules for searching. We are working with a few people for OWL specification of LIPID classes.


  * How are functional groups extracted from classified structures?

Custom code. Of course, we are not talking about functional groups per se, but substructures.

  * How are the classes defined (to which the molecules are classified by structure by extraction of FGs)?

Lipidmaps classification, produced by hand and now maintained by Nature Publishing Group.

  * Tools/technologies?

Virtuoso, own code for graph parsing and extraction of substructures (FGs) from connectivity tables in SDF molecular specifications to obtain an SDF representation of the substructure. Pass to CDK for SMILES string which is hashed and then used for fingerprinting and RDF representation. Consensus description of what functional groups are present in a particular class which is then passed on to the ontology classification. Construct tree which tells us in which particular class the molecule would fit within a larger ontology. We can also tell where within an ontology a class that we may define as human users or practicing (bio)chemists (not mutually exclusive) in the process of revising our ontology, will fit.

Ontology thus derived from consensus: where does it fit in the ontology tree.

Not ready for being tried out yet but will be available soon. Its results, and perhaps even the classifier will be available for use online, and will be similar to the CHESS interface.

## combination of machine learning and functional group approaches? ##

  * reasoner and library integration?

SMARTS based list of classifications : some functional groups are available online (Action point: Egon to send link if there are available catalogues of SMARTS for classes online). **Actually, the file is called SMARTS InteLigand txt, and is included with openbabel - LEO. (I am not sure if Egon has a better set.)**

> Curators would need to be well versed with SMARTS to generate SMARTS-class test links.

Substructure description of functional groups alone would not work? (Explicit hydrogens might go missing: have to generate hydrogens) Alcohol: OH group. In SMARTS you can restrict the number of connections to the particular molecule, while as a simple substructure, you cannot make this restriction. More powerful in terms of limitations that are placed on the graph you search for. Can do the same thing by defining a couple of graphs. How many bonds a certain atom is connected to. R group does not capture the full possibility of expressivity of SMARTS.

SMARTS pattern for two interesting structures separated by a certain length of carbon chain not possible? Egon: this is possible.

Lipid maps classification contains 100-odd classes and 10000 compounds.

Need 30 structures or more for machine learning approaches. ChEBI not really a good ontology for machine learning approaches! Lipidmaps has occasional errors which throws off the classification algorithm. ROOR or COOC and one compound contains HOOC (an error) which throws away the classification algorithm. Lipids: not so diverse in the chemical space. ChEBI: not so many terminal classes.

How do we go about getting a test set of compounds and classes for purposes of classification? By hand? Select set of ChEBI classes which represents the diversity (Egon can assess diversity), extract the terminal classes for these (Action point: Janna)

## implementation, data, evaluation ##

  * time taken for classification of novel compound?
  * function-based class recognition?
  * benchmarking steps? (distance from curated position in classification)


Leo: assess whether fingerprint that is generated is unique to a particular class, and whether a MCS consensus to a particular class is known. Set of substructures unique to the particular class. Without uniqueness we are not able to classify.

Classification based solely on structure would arrive at a scheme which would contain all the possible classes that contain a certain combination of substructures etc. Human classified set & learning: concerned with human classified set. Nico: Inter-annotator agreement study NB for evaluation against human classified classes and structures. (Do humans agree on the classification?)

Performance: SPARQL query for subgraph isomorphism will take a long time. NB : have to know what you're doing. MCS in CDK was slooooow. Someone else's was better. Can't remember exact number.

Function-based classes: would be great to get these from ChEBI. Some role based classes are weird, like Vitamin C. Action item for Janna: find roles with maximum number of compounds associated to them. (list of top 10).